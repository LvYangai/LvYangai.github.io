(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{352:function(e,t,n){"use strict";n.r(t);var o=n(33),a=Object(o.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"练习题34道"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#练习题34道"}},[e._v("#")]),e._v(" 练习题34道")]),e._v(" "),n("h2",{attrs:{id:"_1、取得每个部门最高薪水的人员名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、取得每个部门最高薪水的人员名称"}},[e._v("#")]),e._v(" 1、取得每个部门最高薪水的人员名称")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("思路\n\n1.获取每个部门的最高工资 显示部门编号和最高工资\n select deptno,max(sal) maxSal from emp group by deptno\n2.使用步骤1的查询结果，为临时表temptable 进行多表查询 并使用员工的deptno 和 sal与temptable 同时消除笛卡尔积\n select * from emp e inner join temptable tt on e.sal=tt.maxSal and e.deptno=tt.deptno\n3.使用步骤1的查询结果替换temptable\n select e.ename,e.sal,e.deptno from emp e inner join (select deptno,max(sal) maxSal from emp group by Deptno) tt on e.sal=tt.maxSal and e.deptno=tt.deptno\n+----------------+\nBLAKE\t2850.00\t30\nSCOTT\t3000.00\t20\nKING\t5000.00\t10\nFORD\t3000.00\t20\n")])])]),n("h2",{attrs:{id:"_2、哪些人的薪水在部门的平均薪水之上"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、哪些人的薪水在部门的平均薪水之上"}},[e._v("#")]),e._v(" 2、哪些人的薪水在部门的平均薪水之上")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("思路\n\n1.获取部门的平均薪水\n select deptno ,avg(sal) avgSal from emp group by deptno\n2.使用步骤1的查询结果，为临时表temptable 进行多表查询 并使用员工的deptno等于temptable表中的deptno 和 sal 大于 temptable表中的avgsal 同时消除笛卡尔积\n   select * from emp e inner join temptable tt on e.deptno=tt.deptno and e.sal>tt.avgSal\n3.使用步骤1的语句替换步骤2中的temptable\n  select * from emp e inner join (select deptno ,avg(sal) avgSal from emp group by deptno) tt on e.deptno=tt.deptno and e.sal>tt.avgSal\n+-----------------+\nALLEN\t30\t1600.00\nJONES\t20\t2975.00\nBLAKE\t30\t2850.00\nSCOTT\t20\t3000.00\nKING\t10\t5000.00\nFORD\t20\t3000.00\n")])])]),n("h2",{attrs:{id:"_3、取得部门中（所有人的）平均的薪水等级"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、取得部门中（所有人的）平均的薪水等级"}},[e._v("#")]),e._v(" 3、取得部门中（所有人的）平均的薪水等级")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("思路\n1.获取员工以及员工的薪水等级\n  select * from emp e inner join salgrade sg on e.sal>=sg.losal and e.sal<=sg.hisal\n2.根据部门编号分组并且计算平均的薪水等级\n  select e.deptno,avg(sg.grade) from emp e inner join salgrade sg on e.sal>=sg.losal and e.sal<=sg.hisal group by e.deptno\n+---------+\n10\t3.6667\n20\t2.8000\n30\t2.5000\n")])])]),n("h2",{attrs:{id:"_4、不准用组函数（max），取得最高薪水"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、不准用组函数（max），取得最高薪水"}},[e._v("#")]),e._v(" 4、不准用组函数（Max），取得最高薪水")]),e._v(" "),n("p",[e._v("思路\n1.根据工资进行降序排列 然后显示所有信息\nselect sal from emp order by sal desc\n2.在步骤1的基础上，获取第一条记录\nselect sal from emp order by sal desc limit 0,1\n+--+\n5000")]),e._v(" "),n("h2",{attrs:{id:"_5、取得平均薪水最高的部门的部门编号"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5、取得平均薪水最高的部门的部门编号"}},[e._v("#")]),e._v(" 5、取得平均薪水最高的部门的部门编号")]),e._v(" "),n("p",[e._v("思路\n1.获取部门的平均工资\nselect deptno ,avg(sal) from emp group by deptno\n2.在步骤1的基础上添加排序 降序排列\nselect deptno ,avg(sal) from emp group by deptno order by avg(sal) desc\n3. 在步骤2的基础上获取第一条记录\nselect deptno ,avg(sal) from emp group by deptno order by avg(sal) desc limit 0,1\n+-------------+\n10\t2916.666667")]),e._v(" "),n("h2",{attrs:{id:"_6、取得平均薪水最高的部门的部门名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6、取得平均薪水最高的部门的部门名称"}},[e._v("#")]),e._v(" 6、取得平均薪水最高的部门的部门名称")]),e._v(" "),n("p",[e._v("思路\n1.链接两张表\nselect * from emp e inner join dept d on e.deptno=d.deptno\n2.分组看各部门薪水\nselect e.deptno,max(d.dname),avg(sal) from emp e inner join dept d on e.deptno=d.deptno group by e.deptno\n3.排序\nselect e.deptno,max(d.dname),avg(sal) from emp e inner join dept d on e.deptno=d.deptno group by e.deptno order by avg(sal) desc\n4.取得薪水最高的部门\nselect e.deptno,max(d.dname),avg(sal) from emp e inner join dept d on e.deptno=d.deptno group by e.deptno order by avg(sal) desc limit 0,1")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("DEPTNO\tMAX(d.DNAME)\tAVG(e.sal)\n10\t\tACCOUNTING\t\t2916.666667\n")])])]),n("h2",{attrs:{id:"_7、求平均薪水的等级最低的部门的部门名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7、求平均薪水的等级最低的部门的部门名称"}},[e._v("#")]),e._v(" 7、求平均薪水的等级最低的部门的部门名称")]),e._v(" "),n("p",[e._v("思路\n1.获取部门的平均工资 并且降序\nselect e.deptno,avg(e.sal) from emp e group by e.deptno order by avg(e.sal)")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("2.使用步骤2的结果作为条件，查询部门编号与步骤2的结果相同的部门名称\n  select d.dname from emp e inner join dept d on e.deptno=d.deptno group by e.deptno order by avg(e.sal) limit 0,1\n\nDNAME\nSALES\n")])])]),n("h2",{attrs:{id:"_8、取得比普通员工-员工代码没有在mgr字段上出现的-的最高薪水还要高的领导人姓名"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8、取得比普通员工-员工代码没有在mgr字段上出现的-的最高薪水还要高的领导人姓名"}},[e._v("#")]),e._v(" 8、取得比普通员工(员工代码没有在mgr字段上出现的)的最高薪水还要高的领导人姓名")]),e._v(" "),n("p",[e._v("思路\n1.获取所有的领导的编号\nselect mgr from emp where mgr is not null group by mgr\n2.根据步骤1的查询结果，获取普通员工的最高工资，empno 不在步骤的查询结果里的\nselect max(sal) from emp where empno not in(select mgr from emp where mgr is not null group by mgr )\n3.使用步骤1的查询结果作为条件获取 empno在这个结果中的所有记录以及sal要大于步骤2的查询结果的所有数据\nselect ename from emp where sal>(select max(sal) from emp where empno not in(select mgr from emp where mgr is not null group by mgr ))")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("max(sal)\n1600.00\n")])])]),n("h2",{attrs:{id:"_9、取得薪水最高的前五名员工"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9、取得薪水最高的前五名员工"}},[e._v("#")]),e._v(" 9、取得薪水最高的前五名员工")]),e._v(" "),n("p",[e._v("思路\n1.根据工资进行降序排列\nselect * from emp  order by sal desc\n2.在步骤1的基础上获取前5条记录\nselect * from emp  order by sal desc limit 0,5")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("EMPNO\tENAME\tJOB\t\t\tMGR\t\tHIREDATE\tSAL\t\t\tCOMM\tDEPTNO\n7839\tKING\tPRESIDENT\t\t\t1981-11-17\t5000.00\t\t\t\t10\n7902\tFORD\tANALYST\t\t7566\t1981-12-03\t3000.00\t\t\t\t20\n7788\tSCOTT\tANALYST\t\t7566\t1987-04-19\t3000.00\t\t\t\t20\n7566\tJONES\tMANAGER\t\t7839\t1981-04-02\t2975.00\t\t\t\t20\n7698\tBLAKE\tMANAGER\t\t7839\t1981-05-01\t2850.00\t\t\t\t30\n")])])]),n("h2",{attrs:{id:"_10、取得薪水最高的第六到第十名员工"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10、取得薪水最高的第六到第十名员工"}},[e._v("#")]),e._v(" 10、取得薪水最高的第六到第十名员工")]),e._v(" "),n("p",[e._v("思路\n1.根据工资进行降序排列\nselect * from emp  order by sal desc\n2.在步骤1的基础上获取前6到10的记录\nselect * from emp  order by sal desc limit 5,5")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("EMPNO\tENAME\tJOB\t\t\tMGR\t\tHIREDATE\tSAL\t\tCOMM\tDEPTNO\n7782\tCLARK\tMANAGER\t\t7839\t1981-06-09\t2450.00\t\t\t10\n7499\tALLEN\tSALESMAN\t7698\t1981-02-20\t1600.00\t300.00\t30\n7844\tTURNER\tSALESMAN\t7698\t1981-09-08\t1500.00\t0.00\t30\n7934\tMILLER\tCLERK\t\t7782\t1982-01-23\t1300.00\t\t\t10\n7521\tWARD\tSALESMAN\t7698\t1981-02-22\t1250.00\t500.00\t30\n")])])]),n("h2",{attrs:{id:"_11、取得最后入职的5名员工"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11、取得最后入职的5名员工"}},[e._v("#")]),e._v(" 11、取得最后入职的5名员工")]),e._v(" "),n("p",[e._v("思路\n1.根据入职时间 降序排列\nselect * from emp order by hiredate desc\n2.在步骤1的基础上获取前五条记录\nselect * from emp order by hiredate desc limit 0,5")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v(" EMPNO\tENAME\tJOB\t\tMGR\t\tHIREDATE\tSAL\t\t\tCOMM\tDEPTNO\n 7876\tADAMS\tCLERK\t7788\t1987-05-23\t1100.00\t\t\t\t20\n 7788\tSCOTT\tANALYST\t7566\t1987-04-19\t3000.00\t\t\t\t20\n 7934\tMILLER\tCLERK\t7782\t1982-01-23\t1300.00\t\t\t\t10\n 7900\tJAMES\tCLERK\t7698\t1981-12-03\t950.00\t\t\t\t30\n 7902\tFORD\tANALYST\t7566\t1981-12-03\t3000.00\t\t\t\t20\n")])])]),n("h2",{attrs:{id:"_12、取得每个薪水等级有多少员工"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_12、取得每个薪水等级有多少员工"}},[e._v("#")]),e._v(" 12、取得每个薪水等级有多少员工")]),e._v(" "),n("p",[e._v("思路\n1.获取所有员工的薪水等级\nselect * from emp e inner join salgrade sg on e.sal>=sg.losal and e.sal<=sg.hisal\n2. 在步骤1的基础上根据工资等级进行分组然后同时数量\nselect sg.grade,count(empno) from emp e inner join salgrade sg on e.sal>=sg.losal and e.sal<=sg.hisal group by sg.grade")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("GRADE\tCOUNT(EMPNO)\n1\t\t\t3\n2\t\t\t3\n3\t\t\t2\n4\t\t\t5\n5\t\t\t1\n")])])]),n("h2",{attrs:{id:"_13、面试题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_13、面试题"}},[e._v("#")]),e._v(" 13、面试题")]),e._v(" "),n("h3",{attrs:{id:"问题1-找出没选过-黎明-老师的所有学生姓名。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#问题1-找出没选过-黎明-老师的所有学生姓名。"}},[e._v("#")]),e._v(" 问题1.找出没选过“黎明”老师的所有学生姓名。")]),e._v(" "),n("p",[e._v("思路\n1.获取黎明老师所教的课的编号\nselect  CNO from c where CTEACHER='黎明'\n2. 根据步骤1的查询结果作为条件 获取所有选过黎明老师课程的学生编号\nselect  sno from sc where cno=(select  CNO from c where CTEACHER='黎明')\n3. 根据步骤2的查询结果获取所有学生编号不在这个范围内的所有学生\nselect * from s where sno not in( select  sno from sc where cno=(select  CNO from c where CTEACHER='黎明'))")]),e._v(" "),n("h3",{attrs:{id:"问题2-列出2门以上（含2门）不及格学生姓名及平均成绩。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#问题2-列出2门以上（含2门）不及格学生姓名及平均成绩。"}},[e._v("#")]),e._v(" 问题2:列出2门以上（含2门）不及格学生姓名及平均成绩。")]),e._v(" "),n("p",[e._v("思路\n1.获取所有的低于60分记录\nselect * from sc where scgrade <60\n2.在步骤1的基础之上根据学生编号进行分组然后筛选掉统计数量低于2的所有记录,\n这就可以获取到所有不及格科目大于等于2的所有学生编号\nselect sno from sc where scgrade <60 group by sno having count(sno)>=2\n3.使用学生表和科目进行多表查询然后根据学生编号分组取平均成绩\nselect s.sno,s.sname,avg(sc.scgrade) from s inner join sc on s.sno=sc.sno group by s.sno\n4.在步骤3的基础上添加where条件 获取sno为步骤2查询结果了\nselect\ns.sno,s.sname,avg(sc.scgrade)\nfrom\ns\ninner join\nsc\non\ns.sno=sc.sno\nwhere s.sno in(select sno from sc where scgrade <60 group by sno having count(sno)>=2)\ngroup by s.sno")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v(" 问题3:即学过1号课程又学过2号课所有学生的姓名。\n   思路\n     1.获取所有学习过课程1  或者 是学习过课程2的所有信息\n       select * from sc where cno =1 or cno=2\n     2.在步骤1的基础上使用sno进行分组 ，并且使用having 筛选掉统计数量不是2的所有记录  （及学习过1也学习过2的所有记录）\n       select sno from sc where cno =1 or cno=2 group by sno having count(sno)>=2\n     3.使用步骤2的查询结果作为条件，查询s表中所有sno在这个范围内的所有学生\n       select * from s where sno in ( select sno from sc where cno =1 or cno=2 group by sno having count(sno)>=2)\n")])])]),n("h2",{attrs:{id:"_14、列出所有员工及领导的姓名"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_14、列出所有员工及领导的姓名"}},[e._v("#")]),e._v(" 14、列出所有员工及领导的姓名")]),e._v(" "),n("p",[e._v("思路\n1.需要使用2个emp表同时做多表查询 ，1个emp是员工表1个emp是领导的表\nselect * from emp e1 inner join emp e2\n2.在步骤1的基础上使用e1(员工)表中的mgr与e2（领导）表中的empno 消除笛卡尔积\nselect * from emp e1 inner join emp e2  on e1.mgr=e2.empno\n3.由于e1表中少显示了一条数据是没有领导的这条因此需要使用外连接\nselect e1.ename,e2.ename from emp e1 left join emp e2  on e1.mgr=e2.empno")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("ename\tename(1)\nSMITH\tFORD\nALLEN\tBLAKE\nWARD\tBLAKE\nJONES\tKING\nMARTIN\tBLAKE\nBLAKE\tKING\nCLARK\tKING\nSCOTT\tJONES\nKING\t\nTURNER\tBLAKE\nADAMS\tSCOTT\nJAMES\tBLAKE\nFORD\tJONES\nMILLER\tCLARK\n")])])]),n("h2",{attrs:{id:"_15、列出受雇日期早于其直接上级的所有员工的编号-姓名-部门名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_15、列出受雇日期早于其直接上级的所有员工的编号-姓名-部门名称"}},[e._v("#")]),e._v(" 15、列出受雇日期早于其直接上级的所有员工的编号,姓名,部门名称")]),e._v(" "),n("p",[e._v("思路\n1.需要使用2个emp表同时做多表查询 ，1个emp是员工表1个emp是领导的表\nselect * from emp e1 inner join emp e2\n2.在步骤1的基础上使用e1(员工)表中的mgr与e2（领导）表中的empno 消除笛卡尔积\nselect * from emp e1 left join emp e2 on e1.mgr=e2.empno\n3.在步骤2的基础上添加条件筛选入职时间比直接领导要早的人\nselect * from emp e1 inner join emp e2 on e1.mgr=e2.empno and e1.hiredate<e2.hiredate\n4.在步骤3的基础上添加dept进行多表查询\nselect e1.empno,e1.ename,d.dname from emp e1 inner join emp e2 on e1.mgr=e2.empno and e1.hiredate<e2.hiredate inner join dept d on e1.deptno=d.deptno")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("empno\tename\tdname\n7369\tSMITH\tRESEARCH\n7499\tALLEN\tSALES\n7521\tWARD\tSALES\n7566\tJONES\tRESEARCH\n7698\tBLAKE\tSALES\n7782\tCLARK\tACCOUNTING\n")])])]),n("h2",{attrs:{id:"_16、列出部门名称和这些部门的员工信息-同时列出那些没有员工的部门"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16、列出部门名称和这些部门的员工信息-同时列出那些没有员工的部门"}},[e._v("#")]),e._v(" 16、列出部门名称和这些部门的员工信息,同时列出那些没有员工的部门.")]),e._v(" "),n("p",[e._v("思路\n1.使用外连接查询emp和dept表\nselect d.dname,e.* from emp e right join dept d on e.deptno=d.deptno")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("dname\tEMPNO\t\tENAME\tJOB\t\t\tMGR\t\tHIREDATE\tSAL\t\t\tCOMM\tDEPTNO\nRESEARCH\t7369\tSMITH\tCLERK\t\t7902\t1980-12-17\t800.00\t\t\t\t20\nSALES\t\t7499\tALLEN\tSALESMAN\t7698\t1981-02-20\t1600.00\t\t300.00\t30\nSALES\t\t7521\tWARD\tSALESMAN\t7698\t1981-02-22\t1250.00\t\t500.00\t30\nRESEARCH\t7566\tJONES\tMANAGER\t\t7839\t1981-04-02\t2975.00\t\t\t\t20\nSALES\t\t7654\tMARTIN\tSALESMAN\t7698\t1981-09-28\t1250.00\t\t1400.00\t30\nSALES\t\t7698\tBLAKE\tMANAGER\t\t7839\t1981-05-01\t2850.00\t\t\t\t30\nACCOUNTING\t7782\tCLARK\tMANAGER\t\t7839\t1981-06-09\t2450.00\t\t\t\t10\nRESEARCH\t7788\tSCOTT\tANALYST\t\t7566\t1987-04-19\t3000.00\t\t\t\t20\nACCOUNTING\t7839\tKING\tPRESIDENT\t\t\t1981-11-17\t5000.00\t\t\t\t10\nSALES\t\t7844\tTURNER\tSALESMAN\t7698\t1981-09-08\t1500.00\t\t0.00\t30\nRESEARCH\t7876\tADAMS\tCLERK\t\t7788\t1987-05-23\t1100.00\t\t\t\t20\nSALES\t\t7900\tJAMES\tCLERK\t\t7698\t1981-12-03\t950.00\t\t\t\t30\nRESEARCH\t7902\tFORD\tANALYST\t\t7566\t1981-12-03\t3000.00\t\t\t\t20\nACCOUNTING\t7934\tMILLER\tCLERK\t\t7782\t1982-01-23\t1300.00\t\t\t\t10\nOPERATIONS\t\t\t\t\t\t\t\n")])])]),n("p",[e._v("17、列出至少有5个员工的所有部门\n思路")]),e._v(" "),n("ol",[n("li",[e._v("使用员工和部门进行多表查询\nselect * from emp e inner join dept d on e.deptno=d.deptno\n2.在步骤1的基础之上使用emp表中的deptno进行分组\nselect * from emp e inner join dept d on e.deptno=d.deptno group by e.deptno\n3.在步骤2的基础上添加分组后的条件筛选 过滤掉人数不足5人的部门\nselect * from emp e inner join dept d on e.deptno=d.deptno group by e.deptno having count(empno)>=5\n4.在步骤3的基础上修改显示里显示部门编号和部门名称和部门人数\nselect e.deptno,max(d.dname),count(empno) from emp e inner join dept d on e.deptno=d.deptno group by e.deptno having count(empno)>=5")])]),e._v(" "),n("p",[e._v("18、列出薪金比\"SMITH\"多的所有员工信息.\n思路\n1.获取SMITH的工资\nselect sal from emp where ename='SMITH'\n2.使用步骤1的查询结果作为条件查询工资比步骤1的查询结果还要多的所有员工\nselect * from emp where sal>( select sal from emp where ename='SMITH')")]),e._v(" "),n("p",[e._v("19、列出所有\"CLERK\"(办事员)的姓名及其部门名称,部门的人数.\n思路\n1.使用emp和dept 进行多表查询并消除笛卡尔积\nselect * from emp e inner join dept d on e.deptno=d.deptno\n2.在步骤1的基础上添加条件筛选，获取所有的职位为CLERK的所有员工姓名和部门名称\nselect e.ename,d.dname from emp e inner join dept d on e.deptno=d.deptno  where e.job='CLERK'\n3.使用emp表统计每个部门下一共拥有多少人并获取部门的编号\nselect deptno,count(empno)countNum  from emp group by deptno\n4.将步骤3的查询结果看成是临时表temptable然后和步骤2进行多表查询 并使用emp表中的deptno和temptable表中的deptno消除笛卡尔积\nselect e.ename,d.dname,tt.countNum from emp e inner join dept d on e.deptno=d.deptno inner join temptable tt on e.deptno=tt.deptno  where e.job='CLERK'"),n("br"),e._v("\n5.使用步骤3的语句替换步骤4中的temptable\nselect e.ename,d.dname,tt.countNum from emp e inner join dept d on e.deptno=d.deptno inner join (select deptno,count(empno)countNum  from emp group by deptno) tt on e.deptno=tt.deptno  where e.job='CLERK'")]),e._v(" "),n("p",[e._v("20、列出最低薪金大于1500的各种工作及从事此工作的全部雇员人数.")]),e._v(" "),n("p",[e._v("思路\n1.根据职位进行分组显示职位名\nselect job from emp group by job\n2.在步骤1的基础上添加对员工数量的统计\nselect job,count(empno) from emp group by job\n3.在步骤2的基础上使用分组后的条件筛选，过滤掉最低工资低于1500的职位\nselect job,count(empno) from emp group by job having min(sal)>1500")]),e._v(" "),n("p",[e._v("21、列出在部门\"SALES\"<销售部>工作的员工的姓名,假定不知道销售部的部门编号.\n思路\n1.获取 SALES 部的部门编号\nselect deptno from dept where dname='SALES'\n2.根据步骤1的查询结果获取emp表中deptno为步骤1的结果的所有数据\nselect ename from emp where deptno=( select deptno from dept where dname='SALES')")]),e._v(" "),n("p",[e._v("22、列出薪金高于公司平均薪金的所有员工,所在部门,上级领导,雇员的工资等级.\n思路\n1.获取所有的员工姓名 部门名称 上级领导\nselect * from emp e1 left join emp e2 on e1.mgr=e2.empno inner join dept d on e1.deptno=d.deptno"),n("br"),e._v("\n2.在步骤1的基础上添加salgrade的多表查询并消除笛卡尔积显示工资的等级\nselect * from emp e1 left join emp e2 on e1.mgr=e2.empno inner join dept d on e1.deptno=d.deptno inner join salgrade sg on e1.sal>=sg.losal and e1.sal<=sg.hisal\n3.获取公司的平均工资\nselect avg(sal) from emp")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v(" 4.在步骤2的基础上获取所有工资高于步骤3的查询结果的所有记录\n   select e1.ename,ifnull(e2.ename,'没有领导'),d.dname,sg.grade from emp e1 left join emp e2 on e1.mgr=e2.empno inner join dept d on e1.deptno=d.deptno inner join salgrade sg on e1.sal>=sg.losal and e1.sal<=sg.hisal where e1.sal>(select avg(sal) from emp)  \n")])])]),n("p",[e._v("23、列出与\"SCOTT\"从事相同工作的所有员工及部门名称.\n思路\n1.获取SCOTT的工作（job）\nselect job from emp where ename='SCOTT'")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("  2.使用emp和dept进行多表查询并消除笛卡尔积\n     select * from emp e inner join dept d on e.deptno=d.deptno\n \n  3. 在步骤2的基础之上使用步骤1的查询语句作为条件查询job为步骤1的查询结果的所有记录\n     select e.ename,d.dname from emp e inner join dept d on e.deptno=d.deptno where job =(select job from emp where ename='SCOTT')\n")])])]),n("p",[e._v("24、列出薪金等于部门30中员工的薪金的其他员工的姓名和薪金.\n思路\n1. 获取部门30中的员工工资\nselect sal from emp where deptno=30\n2.使用步骤1的查询结果作为条件，获取员工的工资在步骤1的查询的这个范围内的所有员工 ,过滤掉部门30的员工（没有查询结果）\nselect * from emp where sal in ( select sal from emp where deptno=30) and deptno !=30")]),e._v(" "),n("p",[e._v("25、列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金.部门名称.\n思路\n1. 获取 部门30中的最高工资 （高于这个值就是高于部门30中所有人）\nselect max(sal) from emp where deptno=30\n2. 使用emp和dept进行多表查询 并消除笛卡尔积\nselect * from emp e inner join dept d on e.deptno =d.deptno\n3.在步骤2的基础上使用步骤1的语句作为条件，查询工资高于步骤1的结果的所有记录\nselect e.ename,e.sal,d.dname from emp e inner join dept d on e.deptno =d.deptno where sal>(select max(sal) from emp where deptno=30)")]),e._v(" "),n("p",[e._v("26、列出在每个部门工作的员工数量,平均工资和平均服务期限.\n思路\n1.根据部门编号进行分组然后统计 员工人数和平均工资\nselect count(empno),avg(sal)  from emp  group by deptno\n2.使用to_days函数获取每个员工的入职年限  . avg((to_days(now())-to_days(HIREDATE))/365) 根据当前日期的到公元元年的天数-员工入职时间到公元元年的天数然后除365 获取的员工入职到现在一共多少年 然后获取平均值\nselect count(empno),avg(sal),avg((to_days(now())-to_days(hiredate))/365)  from emp  group by deptno")]),e._v(" "),n("p",[e._v("27、列出所有员工的姓名、部门名称和工资。\n思路\n1.使用emp和dept直接进行多表查询\nselect e.ename,e.sal,d.dname from emp e inner join dept d on e.deptno=d.deptno")]),e._v(" "),n("p",[e._v("28、列出所有部门的详细信息和人数")]),e._v(" "),n("p",[e._v("思路\n1.使用emp和dept进行多表查询，然后根据dept 表中的deptno进行分组，然后根据emp表中的empno进行统计（使用外连接）\n由于dept表中的deptno是分组聚合的因此显示列中的dnamne 和loc也必须是要聚合，可以使用聚合函数也可以添加到分组中\nselect d.deptno,max(d.dname),min(d.loc),count(e.empno) from emp e right join dept d on e.deptno=d.deptno group by d.deptno")]),e._v(" "),n("p",[e._v("29、列出各种工作的最低工资及从事此工作的雇员姓名\n思路\n1.获取各种工作的最低工资\nselect job ,min(sal) minSal  from emp group by job\n2.将步骤1的查询结果当成临时表temptable 与emp 进行多表查询，使用emp中的job和sal与temptable表中的job和minsal消除笛卡尔积\nselect * from emp e inner join temptable tt on e.job=tt.job and e.sal=tt.minSal\n3.使用步骤1的语句替换步骤2中的temptable\nselect * from emp e inner join ( select job ,min(sal) minSal  from emp group by job) tt on e.job=tt.job and e.sal=tt.minSal")]),e._v(" "),n("p",[e._v("30、列出各个部门的MANAGER(领导)的最低薪金")]),e._v(" "),n("p",[e._v("思路\n1.获取所有的MANAGER的员工\nselect * from emp where job ='MANAGER'\n2.在步骤1的基础上添加对部门的分组 然后显示最低工资\nselect deptno,min(sal) from emp where job ='MANAGER' group by deptno")]),e._v(" "),n("p",[e._v("31、列出所有员工的年工资,按年薪从低到高排序\n思路\n1. 年薪=sal*12  或年薪=(sal+comm)"),n("em",[e._v("12  ,comm有可能为null因此需要使用ifnull函数 年薪=(sal+ifnull(comm,0))"),n("em",[e._v("12\nselect   ename ,sal")]),e._v("12 from emp order by sal")]),e._v("12\nselect   ename ,(sal+ifnull(comm,0))*12 from emp order by (sal+ifnull(comm,0))*12")]),e._v(" "),n("p",[e._v("32、求出员工领导的薪水超过3000的员工名称与领导名称\n思路\n1.使用2个emp进行多表查询，emp1为 员工表 emp2为领导表，使用emp1中的mgr和emp2中的empno消除笛卡尔积\nselect e1.ename,e2.ename   from emp e1 inner join emp e2 on e1.mgr=e2.empno where e2.sal>3000")]),e._v(" "),n("p",[e._v("33、求出部门名称中,带'S'字符的部门员工的工资合计、部门人数")]),e._v(" "),n("p",[e._v("思路\n1.使用emp和dept 进行多表查询，并消除笛卡尔积\nselect * from emp e right join dept d on e.deptno=d.deptno"),n("br"),e._v("\n2.在步骤1的基础上过滤掉部门名中没有s的部门\nselect * from emp e right join dept d on e.deptno=d.deptno   where d.dname like '%S%'\n3.在步骤2的基础上根据部门编号和部门名进行分组\nselect * from emp e right join dept d on e.deptno=d.deptno   where d.dname like '%S%'  group by d.deptno\n4.在步骤3的基础上添加显示列统计部门的人数，和工资合计\nselect d.deptno,max(d.dname),ifnull(sum(sal),0) ,count(empno) from emp e right join dept d on e.deptno=d.deptno   where d.dname like '%S%'  group by d.deptno")]),e._v(" "),n("p",[e._v("34、给任职日期超过30年的员工加薪10%\nselect empno from emp where (to_days(now())-to_days(hiredate))/365>30\n错误的 ，更新时where 写不了子查询\nupdate emp set sal=sal*1.1 where empno in( select empno from emp where (to_days(now())-to_days(hiredate))/365>30)")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("update emp set sal=sal*1.1 where (to_days(now())-to_days(hiredate))/365>30\n")])])])])}),[],!1,null,null,null);t.default=a.exports}}]);